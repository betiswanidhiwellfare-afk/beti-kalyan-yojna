<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard ‚Äì UI Only</title>
<style>
/* ===== Global ===== */
body{
    margin:0;
    font-family:"Segoe UI",Tahoma,Arial;
    background:#f2f4f7;
    display:flex;
}

/* ===== Sidebar ===== */
.sidebar{
    position:fixed;
    top:0;left:0;
    width:230px;height:100%;
    background:#e8f1f8;
    border-right:1px solid #c3d4e6;
}
.sidebar::before{
    content:"Government Services";
    display:block;
    background:#003366;
    color:#fff;
    padding:14px 16px;
    font-weight:600;
}
.sidebar a{
    display:block;
    padding:12px 18px;
    color:#003366;
    text-decoration:none;
    border-bottom:1px solid #d5e2ee;
}

/* ===== Main ===== */
.main{margin-left:230px;width:100%;}

/* ===== Header ===== */
header{
    background:linear-gradient(90deg,#ff9933,#ffffff,#138808);
    border-bottom:3px solid #003366;
    padding:10px 18px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
.profile-wrapper img{
    width:38px;height:38px;border-radius:50%;
    border:2px solid #003366;
}

/* ===== Poster ===== */
.poster{
    max-width:700px;
    margin:20px auto;
    background:#fff;
    border:5px solid #ff9933;
    border-radius:12px;
    overflow:hidden;
}
.poster .head{
    background:linear-gradient(180deg,#ff9933,#ffffff,#138808);
    text-align:center;
    padding:20px;
}

.details-grid{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:18px;
    padding:20px;
}
.detail-box{
    width:100%;max-width:500px;
    background:#f9fbfd;
    border:1px solid #c3d4e6;
    border-radius:8px;
    padding:18px;
    text-align:center;
}
.detail-box input{
    width:100%;
    padding:10px;
    margin-top:8px;
    border:1px solid #ccc;
    border-radius:4px;
}
.transfer-btn{
    margin-top:15px;
    padding:10px 24px;
    background:#006600;
    color:#fff;
    border:none;
    border-radius:6px;
    font-size:17px;
}

/* ===== Footer ===== */
.gov-footer{
    background:#003366;
    color:#fff;
    text-align:center;
    padding:20px;
    font-size:13px;
    border-top:4px solid #ff9933;
}
.sidebar a#logoutSidebar {
    color: #ff3333;
    font-weight: 600;
}
.sidebar a#logoutSidebar:hover {
    background: #ffe6e6;
}

.gov-footer a{color:#ffcc00;text-decoration:none;}
</style>
</head>
<body>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>firebase.auth().onAuthStateChanged(user => {
    if(!user){
        window.location.href = "index.html";
    }
});
</script>


<script>
const firebaseConfig = {
  apiKey: "AIzaSyAPSLZU2rGmBTjugMGXzLHpznOaRUW3i4k",
  authDomain: "betikalyanyojnaind.firebaseapp.com",
  projectId: "betikalyanyojnaind",
  storageBucket: "betikalyanyojnaind.firebasestorage.app",
  messagingSenderId: "646974816722",
  appId: "1:646974816722:web:6b0c9c8960d1846a8e480b"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Check if user is logged in
auth.onAuthStateChanged(user => {
    if (!user) {
        // Not logged in ‚Üí redirect to login page
        window.location.href = "login.html";
    } else {
        // Logged in ‚Üí load user data
        const aadhaar = user.email.split("@")[0]; // extract Aadhaar
      db.collection("users").doc(aadhaar)
.onSnapshot(doc => {
    if(doc.exists){
        const data = doc.data();

        document.querySelector('input[placeholder="Applicant Name"]').value = data.name;
        document.querySelector('input[placeholder="Aadhaar Number"]').value = data.aadhaar;
        document.getElementById("receivedAmount").value =
    "‚Çπ" + (data.balance || 0);
    // üîπ Check latest pending withdraw
db.collection("withdrawRequests")
  .where("userId", "==", aadhaar)

  .where("status", "==", "Pending")
  .orderBy("requestedAt", "desc")
  .limit(1)
.onSnapshot(snapshot => {
    const transferInput = document.getElementById("withdrawAmount");
    const transferBtn = document.querySelector(".transfer-btn");

    if(snapshot.empty){
        document.getElementById("transferStatus").value = "‚Äî";
        transferInput.disabled = false;   // allow new request
        transferBtn.disabled = false;     // enable button
    } else {
        const latest = snapshot.docs[0].data();
        document.getElementById("transferStatus").value = "Pending: ‚Çπ" + latest.amount;
        transferInput.disabled = true;    // block new request
        transferBtn.disabled = true;      // disable button
    }
});




    }
});
    }
});
</script>


<div class="sidebar">
    <a href="profile.html">‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</a>
    <a href="user details.html">‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£</a>
    <a href="activation.html">‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§ï‡§∞‡•á</a>
    <a href="refferal.html">‡§∞‡•á‡§´‡§∞‡§≤</a>
    <a href="support.html">‡§∏‡§™‡•ã‡§∞‡•ç‡§ü</a>
    <a href="#" id="logoutSidebar">‡§≤‡•â‡§ó ‡§Ü‡§â‡§ü</a>
</div>

<div class="main">
<header>
    <h3> ‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£ ‡§Ø‡•ã‡§ú‡§®‡§æ</h3>
    <div class="profile-wrapper">
        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
    </div>
</header>

<div class="poster">
    <div class="head">
        <h1>‡§¨‡•á‡§ü‡•Ä ‡§ú‡•Ä‡§µ‡§® ‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£ ‡§Ø‡•ã‡§ú‡§®‡§æ</h1>
        <p>‡§¨‡•á‡§ü‡•Ä ‡§ï‡§æ ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç</p>
    </div>

    <div class="details-grid">
        <div class="detail-box">
            <span>‡§®‡§æ‡§Æ</span>
            <input type="text" placeholder="Applicant Name" readonly>
        </div>
        <div class="detail-box">
            <span>‡§Ü‡§ß‡§æ‡§∞</span>
            <input type="text" placeholder="Aadhaar Number" readonly>
        </div>
        <div class="detail-box">
            <span>‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§∏‡§π‡§Ø‡•ã‡§ó ‡§∞‡§æ‡§∂‡§ø</span>
            <input type="text" id="receivedAmount" placeholder="0" readonly>
        </div>
    <div class="detail-box">
    <span>‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§∞‡§æ‡§∂‡§ø</span>
    <input type="number" id="withdrawAmount" placeholder="‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
    <button class="transfer-btn" onclick="openWithdrawBar()">‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
</div>

   
</div>





</div>



    <script>
// Logout from sidebar
document.getElementById("logoutSidebar").addEventListener("click", function(e){
    e.preventDefault(); // prevent default link behavior
    auth.signOut().then(() => {
        window.location.href = "index.html";
    });
});
// üîπ Open Withdraw Panel
function openWithdrawBar() {
    const userId = firebase.auth().currentUser.email.split("@")[0];

    db.collection("users").doc(userId).get().then(doc => {
        const data = doc.data();

        document.getElementById("barAcc").innerText  = data.account || "‚Äî";
        document.getElementById("barIfsc").innerText = data.ifsc || "‚Äî";
        document.getElementById("barUpi").innerText  = data.upi || "‚Äî";

        document.getElementById("withdrawBar").style.bottom = "0";
        document.getElementById("wAmount").value = document.getElementById("withdrawAmount").value || "";
    });
}

function closeWithdrawBar() {
    document.getElementById("withdrawBar").style.bottom = "-100%";
}


// üîπ Submit Withdraw
function submitWithdrawRequest() {
    const amount = Number(document.getElementById("wAmount").value);
    const userId = firebase.auth().currentUser.email.split("@")[0];

    if (!amount || amount <= 0) {
        alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç");
        return;
    }

    db.collection("users").doc(userId).get().then(doc => {
        const data = doc.data();
        const balance = data.balance || 0;

        if (amount > balance) {
            alert("‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§∞‡§æ‡§∂‡§ø ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§∞‡§æ‡§∂‡§ø ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä");
            return;
        }

        const method = document.querySelector('input[name="withdrawType"]:checked').value;
        const details = method === "account"
            ? { account: data.account, ifsc: data.ifsc }
            : { upi: data.upi };

        db.collection("withdrawRequests").add({
            userId,
            amount,
            method,
            details,
            status: "Pending",
            requestedAt: firebase.firestore.FieldValue.serverTimestamp()
        }).then(() => {
            alert("‡§Ü‡§™‡§ï‡•Ä ‡§∞‡§æ‡§∂‡§ø ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§π‡•ã ‡§ó‡§Ø‡§æ ‚úÖ");
            closeWithdrawBar();
            document.getElementById("withdrawAmount").value = "";
        });
    });
}


       


</script>



    <footer class="gov-footer">
        <p>‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§à‡§Æ‡•á‡§≤ : <a href="#">helpdesk@betijivankalyan.gov.in</a></p>
        <p>¬© 2026 ‡§∏‡§≠‡•Ä ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§</p>
    </footer>
</div>
</div>
<!-- Withdraw bar -->
<div id="withdrawBar" style="
    position:fixed;
    bottom:-100%;
    left:0;
    width:100%;
    background:#ffffff;
    border-top:4px solid #ff9933;
    box-shadow:0 -4px 12px rgba(0,0,0,0.25);
    padding:18px;
    transition:0.4s ease;
    z-index:9999;
">
    <h3 style="margin-top:0;color:#003366;">‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§µ‡§ø‡§ß‡§ø ‡§ö‡•Å‡§®‡•á‡§Ç</h3>

    <label style="display:block;margin-top:10px;">
        <input type="radio" name="withdrawType" value="account" checked> ‡§¨‡•à‡§Ç‡§ï ‡§ñ‡§æ‡§§‡§æ
    </label>

    <div style="margin-left:20px;margin-top:6px;font-size:14px;">
        <div><b>Account:</b> <span id="barAcc"></span></div>
        <div><b>IFSC:</b> <span id="barIfsc"></span></div>
    </div>

    <label style="display:block;margin-top:12px;">
        <input type="radio" name="withdrawType" value="upi"> UPI ID
    </label>

    <div style="margin-left:20px;margin-top:6px;font-size:14px;">
        <div><b>UPI:</b> <span id="barUpi"></span></div>
    </div>

    <div style="margin-top:10px;">
        <label>‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</label>
        <input type="number" id="wAmount" placeholder="‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç" style="width:100%;padding:6px;margin-top:4px;">
    </div>

    <button onclick="submitWithdrawRequest()" style="
        margin-top:16px;
        padding:10px 20px;
        background:#006600;
        color:#fff;
        border:none;
        border-radius:6px;
        cursor:pointer;
        font-size:15px;
        width:100%;
    ">‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</button>

    <button onclick="closeWithdrawBar()" style="
        margin-top:10px;
        padding:8px 16px;
        background:#555;
        color:#fff;
        border:none;
        border-radius:6px;
        cursor:pointer;
        width:100%;
    ">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
</div>

</body>
</html>
